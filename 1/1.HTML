<!DOCTYPE html>
<html>
    <head>

    

        <meta charset="utf-8">
        <title>game 1</title>
        <style media="screen">
            canvas {
                border: 1px black solid;
            }
        </style>
    </head>
    <body>
        <canvas id="id-canvas" width="400" height="300"></canvas>



  <!-- 为了避免加载速度较慢，现代Web应用程序一般都把全部JavaScript引用放在<body>元索中，放在页面的内容后面。 -->
    <script>
//封装一切和画图有关的变量
var imageFromPath=function (path) {
    var img=new Image()
    img.src=path
    return img
}

//封装一切和挡板有关的变量
//arg 是canves作为参数传入，用以限制挡板的移动范围
var Paddle=function (arg) {
    var image=imageFromPath('pad.png')
    //参数封装对象
    var o={
        image:image,
        x:100,
        y:200,
        speed:5,
    }
    o.moveLeft=function () {
        if (o.x>0) {
            o.x-=o.speed
        }
        
    }
     o.moveRight=function () {
        if (o.x<arg.width-image.width) { o.x+=o.speed}
       
    }
    return o
}

//一些设置系列的对象
var Config=function() {

    var g={}

    var log=console.log.bind(console)
    var canvas=document.querySelector('#id-canvas')
    var context=canvas.getContext('2d')
    g.canvas=canvas
    g.context=context

    //定时更新实现稳定30fps
    setInterval(function(){
        //update x
        g.update()
   
        //clear
        context.clearRect(0,0,canvas.width,canvas.height)
     //draw
        g.draw()
        
        
    },1000/30) 

    return g
}

//唯一调用的入口函数
var __main=function () {
    var config=Config()
    var paddle=Paddle(config.canvas)
    var leftDown=false
    var rightDown=false



    //window event
    window.addEventListener('keydown', function(event){
        //log(event)
        var k=event.key
        if (k=='a') {
            leftDown=true
        }
        if (k=='d') {
            rightDown=true
        }
    })

    window.addEventListener('keyup', function(event){
        //log(event)
        var k=event.key
        if (k=='a') {
            leftDown=false
        }
        if (k=='d') {
            rightDown=false
        }
    })

    config.update=function() {
            if (leftDown) {
                    paddle.moveLeft()
                    }
                if (rightDown) {
                    paddle.moveRight()
                    }
        }
    config.draw=function() {
            config.context.drawImage(paddle.image,paddle.x,paddle.y)
    }

   
}


__main()


//49:56
//https://www.bilibili.com/video/av12138532/
    </script>
    </body>


  
</html>